name: APITest
on:
  issue_comment:
    types: [created]

jobs:
  
  build:
    runs-on: ubuntu-latest
    steps:        
        - name: Checkout
          uses: actions/checkout@v2.4.0
        
        - name: Create status check
          env:
             GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          run: |
            BUILD_COMMIT=$(git rev-parse HEAD)
            curl \
            -X POST \
            -H "Authorization: Bearer $GITHUB_TOKEN" \
            -H "Accept: application/vnd.github.v3+json" \
            https://api.github.com/repos/WorkshopOrgTest/PartsTest/check-runs \
            -d '{"name":"build", "head_sha": "'"$BUILD_COMMIT"'", "status": "completed", "conclusion": "success" }'
      
#       - name: Deploy Stage
#         uses: WorkshopOrgTest/api-composite-action@v2.3
#         with:
#           Token: ${{secrets.API_TOKEN}}
#           Header: ${{secrets.HEADER}}
#           RequestBody: ${{secrets.REQUESTBODY}}
#           ExpectedOutput: ${{secrets.EXPECTEDOUTPUT}}
    
#   deploy:
#      runs-on: ubuntu-latest
#      needs: build
#      steps:
#       - uses: actions/checkout@v2
